/*
	UIZE JAVASCRIPT FRAMEWORK 2011-11-14

	http://www.uize.com/reference/Uize.Template.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Template',required:'Uize.String',builder:function(){var _a=function(){},_b=true,_c=false,_d='string',_e=Uize.String,_f=_e.splitInTwo,_g=_e.trim;var _h={},_i=/^\s*=/,_j=/^\s*@/,_k=/^\s*\./,_l=/^!\s*/,_m=/(\r|\n|\r\n)[ \t]*$/,_n=/^[ \t]*(\r|\n|\r\n)[ \t]*/,_o='->',_p={};function _q(_r,_s,_t,_u){if(_s){_s=_s.split(_o);for(var _v= -1,_w=_s.length,_x,_y,_z,_A;++_v<_w;){if(_y=_g((_x=_f(_s[_t?_w-_v-1:_v],'{'))[0])){if(_z=_l.test(_y))_y=_y.replace(_l,'');if(_A=_a.encodings[_y]){if(_t)_z= !_z;var _B=_g(_x[1]),_C=_z?'from':'to',_D=_A[_C];_u&&_u(_y+':'+_C,_D.required);_r=_D.expansion(_r,_B?('{'+_B):'');}}}}return _r;}_a.compile=function(_E,_F){_F=_F||_h;var _G=[],_H={},_I={},_J={},_K=_F.openerToken||'<%',_L=_F.closerToken||'%>',_M=_F.gobbleWhitespace!==_c,_N=_E.length,_O='var output = [];',_P='return output.join (\'\');',_Q=[_O],_R=[],_S=0,_T,_U=_b,_V,_W,_X,_Y,_Z;function _0(_W){if(_R.length){_Q.push('output.push ('+_R.join(',')+');');_R=[];}_Q.push(_W);}function required(_1){if(_1){
if(typeof _1==_d)_1=_1.split(',');for(var _2= -1,_3=_1.length,_4;++_2<_3;){if(!_H[_4=_1[_2]]){_G.push(_4);_H[_4]=1;}}}}function input(_5){Uize.copyInto(_J,_5);}function startBlock(_6,_7){_0('function '+_6+' ('+(_7||'')+') {'+_O);}function endBlock(){_0(_P+'}');}while(_U){_T=_E.indexOf(_K,_S);if(_T<0)_T=_N;_V=_E.slice(_S,_T);if(_U=_T<_N){_S=_E.indexOf(_L,_T+=2);_Y=_i.test(_W=_E.slice(_T,_S));_Z=_Y||_k.test(_W);_X= !_Z&&_j.test(_W);_S+=2;}if(_V){if(_M&&_U&& !_Z&&_m.test(_V)&&_n.test(_E.substr(_S)))_V=_V.replace(_m,'');_V&&_R.push('\''+_V.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/\'/g,'\\\'')+'\'');;}if(_U){if(_Z){var _8=_f(_Y?_W.replace(_i,''):'input'+_W,_o);_R.push(_q(_g(_8[0]),_8[1],_c,function(_9,_ba){if(!_I[_9]){required(_ba);_I[_9]=1;}}));}else if(_X){eval(_W.replace(_j,''));}else{_0(_W);}}}_0(_P);var _bb=_Q.join('\n'),_bc=new Function('input',_bb);return(_F.result=='full'?{input:_J,required:_G,code:_bb,templateFunction:_bc}:_bc);};_a.encode=function(_bd,_s,_t){
var _be=(_t?'! ':'')+_s;return((_p[_be]||(_p[_be]=new Function('e','return '+_q('e',_s,_t))))(_bd));};_a.decode=function(_bf,_A){return _a.encode(_bf,_A,_b)};var _bg=_a.defineStandardEncoding=function(_y,_bh,_bi,_bj){var _bk=_bh+'.'+_bj+' (',_bl=_bh+'.'+_bi+' (';_a.encodings[_y]={to:{required:_bh,expansion:function(_bm,_bn){return _bl+_bm+(_bn&&',')+_bn+')'}},from:{required:_bh,expansion:function(_bm,_bn){return _bk+_bm+(_bn&&',')+_bn+')'}}};};_a.encodings={};_bg('iso8601','Uize.Date','toIso8601','fromIso8601');_bg('json','Uize.Json','to','from');_bg('miniJson','Uize.Json','to','from');_a.encodings.miniJson.to.expansion=function(_bm){return'Uize.Json.to ('+_bm+',\'mini\')'};_bg('tagAttributes','Uize.Xml','toAttributes','fromAttributes');_bg('tagAttributeValue','Uize.Xml','toAttributeValue','fromAttributeValue');_bg('url','Uize.Url','resolve','from');_bg('urlParams','Uize.Url','toParams','fromParams');_bg('urlPiece','Uize.Url','toPiece','fromPiece');return _a;}});