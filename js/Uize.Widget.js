/*
	UIZE JAVASCRIPT FRAMEWORK 2011-04-21

	http://www.uize.com/reference/Uize.Widget.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget',required:'Uize.Node',builder:function(b_a){var b_b=null,b_c=true,b_d=false,b_e='string',b_f=Uize.isFunction,b_g='concatenated',b_h,b_i=Uize.Node,b_j=b_i.doForAll,b_k=b_i.isNode,b_l=b_i.getById;var b_m=b_a.subclass(function(b_n){var b_o=b_n&&b_n.idPrefix;if(b_o){var b_p=b_q(b_o,b_n.parent);b_p&&Uize.copyInto(b_n,b_p);}this.children=this.b_r={};}),b_s=b_m.prototype;function b_q(b_o,b_t){var b_u,b_v;if(b_o&&(b_u=window[b_v='$'+b_o])&&typeof b_u=='object'&&(!b_t||b_o!=b_t.b_o)){delete b_u.children;delete b_u.widgetClass;window[b_v]=b_h;}else{b_u=b_h;}return b_u;}b_s.b_w=function(){var b_p=b_q(this.b_o,this.parent);b_p&&this.set(b_p);};b_s.b_x=function(b_y,b_z,b_A,b_B){return((b_B==b_g|| !b_B)&&b_y!=b_h?(b_y+(b_A!==''?'_':'')+b_A):(b_B=='same as parent'?b_y:b_z));};var b_C={b_D:b_d,b_E:b_c};b_s.b_F=function(){(this.b_G=='inherit'?(this.parent||b_C).b_D:this.b_G)!=this.b_D&&this.set({b_D:!this.b_D});};b_s.b_H=function(){(this.b_I=='inherit'?(this.parent||b_C).b_E:this.b_I)
!=this.b_E&&this.set({b_E:!this.b_E});};b_s.b_J=function(b_K,b_L,b_M){var b_N='show'+Uize.capFirstChar(b_K);this.getProvider(b_N)?this.callInherited(b_N)(b_L):setTimeout(function(){var b_O=b_M();(b_L.callback||(b_O?b_L.yesHandler:b_L.noHandler)||function(){})(b_O)},0);};b_s.confirm=function(b_L){this.b_J('confirm',b_L,function(){return confirm(b_L.message)});};b_s.showInform=b_s.showConfirm=b_h;b_s.inform=function(b_L){this.b_J('inform',b_L,function(){alert(b_L.message);return b_c})};b_s.ajax=function(b_P,b_Q){this.callInherited('performAjax')(b_P,Uize.isFunction(b_Q)?{callback:b_Q}:b_Q||{})};b_s.localize=function(b_R,b_S,b_T){var b_U,b_V=this;while(!(b_U=b_V.b_W?b_V.b_W[b_R]:b_h)&&(b_V=b_V.parent));return(b_f(b_U)?b_U.call(this,b_S):Uize.substituteInto(b_U,b_S,b_T||'{KEY}'));};b_s.buildHtml=function(b_X){var b_Y=this,b_Z=b_Y.b_Z;if(b_Z!=b_h){var b_0=b_Y.b_1||b_Y.getNode('shell')||b_Y.getNode();if(b_Z===b_c){b_Z=b_Y.b_Z=Uize.Template&&b_0?{process:Uize.Template.compile((
b_i.find({root:b_0,tagName:'SCRIPT',type:'text/jst'})[0]||b_0).innerHTML,{openerToken:'[%',closerToken:'%]'})}:b_h;if(!b_Z)return;}b_Y.b_o||b_Y.set({b_o:b_Y.instanceId});var b_2=Uize.copyInto({pathToResources:Uize.pathToResources,blankGif:b_m.getBlankImageUrl()},b_X||b_Y.get());b_i.injectHtml(b_0||document.body,typeof b_Z!=b_e&&b_f(b_Z.process)?b_Z.process.call(b_Y,b_2):Uize.substituteInto(b_f(b_Z)?b_Y.b_Z(b_2):b_Z,b_2),b_Y.b_3||(b_0?'inner replace':'inner bottom'));b_Y.b_4=b_b;b_Y.set({b_5:b_c});}};function b_6(b_7,b_8){b_s[b_7+'Node'+b_8]=new Function('arguments.length'+'?(arguments[0]=this.getNode(arguments[0]))'+':(arguments[arguments.length++]=this.getNode());'+'return Uize.Node.'+b_7+b_8+'.apply(0,arguments)');}b_s.getNode=function(b_9){if(b_9==b_b){if(b_9===b_b)return b_b;b_9='';}var b_Y=this;if(b_Y.b_ba&&typeof b_9==b_e){var b_bb=b_Y.b_ba[b_9];if(b_bb!==b_h)b_9=b_bb;}if(typeof b_9==b_e){return b_l(b_9,b_Y.b_o,b_Y.b_4||(b_Y.b_4={}));}else if(b_k(b_9)){return b_9;}else{var b_u=b_b;b_j(b_9,
function(b_bc){(b_u||(b_u=[])).push(b_bc)},b_Y.b_o,b_Y.b_4||(b_Y.b_4={}));return b_u;}};b_6('get','Style');b_6('get','Value');b_s.flushNodeCache=function(b_bd){if(this.b_4)b_bd==b_h?(this.b_4=b_b):delete this.b_4[b_bd];};b_s.globalizeNode=function(b_be){var b_Y=this,b_bf=document.body;b_j(b_Y.getNode(b_be),function(b_bc){if(b_bc.parentNode!=b_bf){(b_Y.b_bg||(b_Y.b_bg=[])).push(b_bc);b_i.setStyle(b_bc,{position:'absolute',left:-10000,top:-10000});b_bf.appendChild(b_bc);}});};b_6('display','');b_6('inject','Html');b_s.removeNode=function(b_be){b_i.remove(this.getNode(b_be));this.flushNodeCache(b_be);};b_6('set','Properties');b_6('set','Opacity');b_6('set','Style');b_6('set','ClipRect');b_6('set','InnerHtml');b_6('set','Value');b_6('show','');b_s.wireNode=function(b_be,b_bh,b_bi){arguments.length==3?b_i.wire(this.getNode(b_be),b_bh,b_bi,this.instanceId):b_i.wire(this.getNode(b_be),b_bh,this.instanceId);};b_s.unwireNode=function(b_be,b_bh,b_bi){if(b_be!==b_h)b_be=this.getNode(b_be);arguments.length==2&&
typeof b_bh=='object'&&b_bh&& !b_bh.virtualDomEvent?b_i.unwire(b_be,b_bh,this.instanceId):b_i.unwire(b_be,b_bh,b_bi,this.instanceId);};b_s.unwireNodeEventsByMatch=function(b_be,b_bj){this.unwireNode(b_be,(b_bj||(b_bj={})).eventName,b_bj.handler);};b_s.addChild=function(b_A,b_bk,b_n){if(!b_n)b_n={};var b_Y=this,b_o=b_Y.b_o,b_bl=Uize.isInstance(b_bk)?b_bk:b_b,b_z='idPrefix'in b_n?b_n.idPrefix:b_n.node,b_bm=b_n.idPrefixConstruction;b_n.parent=b_Y;if(b_A==b_h)b_A=b_n.name;if(b_bl){if(b_A==b_h)b_A=b_bl.b_bn;if(b_z==b_h)b_z=b_bl.b_o;if(!b_bm)b_bm=b_bl.b_B;}b_n.idPrefix=b_Y.b_x(b_o,b_z,b_n.name=b_A,b_n.idPrefixConstruction=b_bm||(b_z==b_h?b_g:'explicit'));b_bl&&b_bl.set(b_n);return b_Y.b_r[b_A]=b_bl||new b_bk(b_n);};b_s.removeChild=function(b_bo){var b_r=this.b_r,b_A=typeof b_bo==b_e||Uize.isNumber(b_bo)?b_bo:b_bo.b_bn,b_bl=b_r[b_A];if(b_bl){b_bl.unwireUi();delete b_bl.parent;delete b_r[b_A];}};b_s.getProvider=function(b_bp){var b_bq=this,b_br;while(((b_br=b_bq.get(b_bp))==='inherit'||b_br===b_h)&&(b_bq=b_bq.parent)
);return b_bq;};b_s.getInherited=function(b_bp){var b_bs=this.getProvider(b_bp);return b_bs?b_bs.get(b_bp):b_h;};b_s.setInherited=function(b_n){var b_bs;for(var b_bt in b_n){if(b_bs=this.getProvider(b_bt))b_bs.set(b_bt,b_n[b_bt]);}};b_s.callInherited=function(b_bp){var b_Y=this;return(function(){var b_bs=b_Y.getProvider(b_bp),b_u;if(b_bs){var b_bu=b_bs.get(b_bp);if(b_f(b_bu))b_u=b_bu.apply(b_bs,arguments);}return b_u;});};b_s.kill=function(){Uize.callOn(this.b_r,'kill');b_a.prototype.kill.call(this);};b_s.insertOrWireUi=function(){this.b_5?this.wireUi():this.insertUi();};b_s.insertUi=function(){this.buildHtml();this.wireUi();};b_s.removeUi=function(){this.unwireUi();this.removeNode();b_i.remove(this.b_bg);this.b_bg=b_h;Uize.callOn(this.b_r,'removeUi');this.set({b_5:b_d});};b_s.updateUi=function(){};b_s.wireUi=function(){if(!this.isWired){this.b_w();this.set({wired:b_c});var b_r=this.b_r;for(var b_A in b_r)b_r[b_A].insertOrWireUi();this.updateUi();}};b_s.unwireUi=function(){if(this.isWired){this.b_4=b_b;
this.unwireNode();Uize.callOn(this.b_r,'unwireUi');this.set({wired:b_d});}};b_m.getBlankImageUrl=function(){return Uize.pathToResources+'Uize/blank.gif';};b_m.spawn=function(b_n,b_t){var b_Y=this,b_bv=[],b_bq,b_bw=b_t&&b_t.b_o?b_t.b_o+'_':'',b_bx=b_bw.length;b_j(Uize.Node.find(b_n.idPrefix),function(b_bc){b_n.idPrefix=b_bc;b_t?(b_bq=b_t.addChild(b_bc.id.slice(0,b_bx)==b_bw?b_bc.id.slice(b_bx):'generatedChildName'+Uize.getGuid(),b_Y,b_n)):(b_bq=new b_Y(b_n)).insertOrWireUi();b_bv.push(b_bq);});return b_bv;};b_m.registerProperties({b_5:{name:'built',value:b_c},b_G:{name:'busy',onChange:b_s.b_F,value:'inherit'},b_D:{name:'busyInherited',onChange:function(){Uize.callOn(this.b_r,b_s.b_F)},value:b_d},b_1:'container',b_I:{name:'enabled',onChange:b_s.b_H,value:'inherit'},b_E:{name:'enabledInherited',onChange:function(){Uize.callOn(this.b_r,b_s.b_H)},value:b_c},b_Z:'html',b_o:{name:'idPrefix|node',conformer:function(b_o){return b_k(b_o)?(b_o.id||(b_o.id=Uize.getGuid())):b_o;},onChange:function(){var b_Y=this,
b_o=b_Y.b_o;b_Y.b_4=b_b;if(b_o!=b_h){b_Y.b_w();var b_r=b_Y.b_r,b_bl;for(var b_A in b_r)(b_bl=b_r[b_A]).set({b_o:b_Y.b_x(b_o,b_bl.b_o,b_A,b_bl.b_B)});if(b_Y.isWired){b_Y.set({wired:b_d});b_Y.wireUi();}}}},b_B:'idPrefixConstruction',b_3:'insertionMode',b_W:'localized',b_bn:'name',b_ba:'nodeMap',isWired:{name:'wired',value:b_d}});return b_m;}});