/*
	UIZE JAVASCRIPT FRAMEWORK 2012-07-08

	http://www.uize.com/reference/Uize.Build.BuildSimpleDocPages.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Build.BuildSimpleDocPages',required:['Uize.Wsh','Uize.Build.Util','Uize.Data.Simple','Uize.Data.PathsTree','Uize.Doc.Simple','Uize.Doc.Sucker','Uize.Template','Uize.String','Uize.Url','UizeDotCom.Build.Util'],builder:function(){var _a=function(){};_a.perform=function(_b){var _c=env.alwaysBuild,_d='~SIMPLE-DOC-TEMPLATE.html.jst',_e,_f,_g=Uize.Wsh.getScriptFolderPath(),_h=_g.length+1,_i,_j={},_k='reference',_l=/\.simple$/i,_m=/\.js$/i;function _n(_o){return Uize.Url.from(_o).fileName;}function _p(_q){return _q.match(/(.*)\.[^\.]*$/)[1].replace(/-/g,' ');}function _r(_o){var _s=Uize.Data.Simple.parse({simple:Uize.Wsh.readFile(_o),collapseChildren:true}).listings;for(var _t= -1,_u=_s.length;++_t<_u;){var _v=_s[_t];if(_v.link)_j[_v.fullName]=_v.link;}}_r('appendixes/credits.html.simpledata');_r('endorsements.html.simpledata');function _w(_x,_y,_z){for(var _A= -1,_B='/'+(_z||_x)+'/',_C=Uize.Wsh.getFiles(_x,_y,_n),_D=_C.length,_E;++_A<_D;)_j[_E=_C[_A]]=_B+_E+'.html';}
_w('javascript-reference',_l);_w(env.moduleFolderPath,_m,_k);function _F(_G){return function(_H,_I){if(!_f){_f=Uize.Build.Util.compileJstFile(_e);var _J=_e.slice(_h);_i=Uize.String.repeat('../',_J.length-_J.replace(/[\/\\]/g,'').length);}var _K=_G(_I);if(_K){var _L=_K.contentsTreeItems,_M=_L[0];return{outputText:_f({title:_K.metaData.title||_p(_H).replace(/(^|\s)[a-z]/g,function(_N){return _N.toUpperCase()}),description:(_M&&(_M.description||(_M.items[0]||{}).description))||'',body:_K.html})};}else{return{};}}}var _l=/\.simple$/i;Uize.Wsh.buildFiles({alwaysBuild:_c,targetFolderPathCreator:function(_O){var _P=Uize.Wsh.fileExists(_e=_O+'\\'+_d)?_O:null;if(_P)_f=null;return _P;},targetFilenameCreator:function(_H){return(_l.test(_H)?_H.replace(_l,'.html'):null);},fileBuilder:_F(function(_Q){return Uize.Doc.Simple.build({data:_Q,urlDictionary:_j,pathToRoot:_i,result:'full'})})});var _R='\\'+env.moduleFolderPath,_S=_R.length,_T,_U=Uize.Data.PathsTree.fromList(Uize.Wsh.getFiles(env.moduleFolderPath,_m,_n)),
_V=UizeDotCom.Build.Util.getExamplesByKeyword();Uize.Wsh.buildFiles({alwaysBuild:_c,logFileName:'_build-pages-from-simple-doc-in-js-modules.log',targetFolderPathCreator:function(_O){var _P=_O.slice(-_S)==_R?_g+'\\'+_k:null;if(_P)Uize.Wsh.fileExists(_e=_P+'\\'+_d)?(_f=null):(_P=null);;return _P;},targetFilenameCreator:function(_H){var _W=_m.test(_H)?_H.replace(_m,'.html'):null;if(_W)_T=_p(_H);return _W;},fileBuilder:_F(function(_X){var _Y;Uize.module({required:_T,builder:function(){var _Z=_j[_T];_j[_T]=null;_Y=Uize.Doc.Sucker.toDocument(_X,{urlDictionary:_j,pathToRoot:_i,result:'full',module:eval(_T),modulesTree:_U,examples:_V[_T]});_j[_T]=_Z;}});return _Y;})});};return _a;}});