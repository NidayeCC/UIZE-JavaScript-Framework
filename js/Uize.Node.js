/*
	UIZE JAVASCRIPT FRAMEWORK 2011-09-16

	http://www.uize.com/reference/Uize.Node.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Node',builder:function(){var _a=function(){},_b,_c='string',_d='object',_e='function',_f=true,_g=false,_h=null,_i='hidden',_j=Uize.copyInto;var _k=typeof navigator!='undefined',_l=_k?navigator:{userAgent:'',appName:''},_m=_l.userAgent.toLowerCase(),_n=_l.appName=='Microsoft Internet Explorer',_o=_m.indexOf('applewebkit')> -1,_p=_m.indexOf('gecko')> -1,_q=_m.indexOf('opera')> -1,_r=_p||_q,_s= +(_n&&(_m.match(/MSIE\s*(\d+)/i)||[0,0])[1]),_t=_n&&_s<9;var _u=_a._u=function(_v){_w.clientX=_v.clientX;_w.clientY=_v.clientY;_w.pageX=_v.pageX;_w.pageY=_v.pageY;};function _x(_y){var _z=document.getElementById(_y);return(!_n||(_z&&_z.id==_y))?_z:_h;}function _A(){return document[_o?'body':'documentElement'];}function _B(_C){var _D=(_C=_C+'').slice(_C.indexOf('(')+1,_C.indexOf(')'));return Function.apply({},(_D?_D.split(','):[]).concat(_C.slice(_C.indexOf('{')+1,_C.lastIndexOf('}'))));}function _E(_F){if(_F.charCodeAt(0)==111&&_F.charCodeAt(1)==110)_F=_F.slice(2);return(
_F.charCodeAt(_F.length-1)==41&&_a.VirtualEvent?_a.VirtualEvent.resolve(_F):_F);}function _G(_H,_I){for(var _J= -1,_z={},_K=Math.min(_H.length,_I.length);++_J<_K;)_z[_H[_J]]=_I[_J];return _z;}var _L=_a._L={},_M={},_N=0,_O={string:1,number:1,boolean:1},_w={clientX:0,clientY:0,pageX:0,pageY:0};var _P='table-',_Q=_P+'row',_R=_P+'cell',_S=_j({SPAN:'inline',THEAD:_P+'header-group',TFOOT:_P+'footer-group',LI:'list-item'},_n&&typeof DOMImplementation=='undefined'?_h:{TABLE:'table',TR:_Q,TH:_R,TD:_R,TBODY:_Q+'-group',COLGROUP:_P+'column-group',COL:_P+'column',CAPTION:_P+'caption'});_a.display=function(_T,_U){_U=_U===_b|| !!_U;_V(_T,function(_W){_W.style.display=_U?(_S[_W.tagName]||'block'):'none';});};var _V=_a.doForAll=function(_T,_C,_X,_Y){if(typeof _T==_c)_T=_Z(_T,_X,_Y);if(_T!=_b){if(_0(_T)){_C(_T);}else{var _1=typeof _T;if((_1==_d||_1==_e)&&typeof _T.length=='number'){for(var _2= -1,_3=_T.length;++_2<_3;)_V(_T[_2],_C,_X,_Y);}else if(_1==_d){for(var _4 in _T)_V(_T[_4],_C,_X,_Y);}}}};var _5=_a.doRectanglesOverlap=
function(_6,_7,_8,_9,_ba,_bb,_bc,_bd){return(_8-1+ +_6>=_ba&&_bc-1+ +_ba>=_6&&_9-1+ +_7>=_bb&&_bd-1+ +_bb>=_7);};var _Z=_a.getById=function(_W,_X,_Y){if(typeof _W!=_c)return _W;var _z=_Y?_Y[_W]:_b;if(_z===_b){var _be=_bf(_X,_W);(_z=_x(_be))||(((_z=document.getElementsByName(_be)).length<2)&&(_z=_z[0]||_h));if(_Y)_Y[_W]=_z;}return _z;};_a.find=function(_bg){if(typeof _bg!=_d|| !_bg||typeof _bg.length=='number'||_0(_bg))return _bg;var _bh=document,_bi=[],_bj=_j({},_bg),_bk='root'in _bj?_Z(_bj.root):_bh;delete _bj.root;if(_bk){var _bl=_bj.tagName;if('id'in _bj&&_O[typeof _bj.id]){var _W=_x(_bj.id);_W&&_bi.push(_W);delete _bj.id;}else if('name'in _bj&&_O[typeof _bj.name]){_bi=_bh.getElementsByName(_bj.name);delete _bj.name;}else{var _bm=_O[typeof _bl];_bm&&delete _bj.tagName;_bi=_bk.getElementsByTagName(_bl&&_bm?_bl:'*');_bk=_h;}if(_bk==_bh)_bk=_h;if(!_bl||_bl=='*')delete _bj.tagName;}var _bn=_bi.length;for(var _bo in _bj)break;if(!_bn||(_bo==_b&& !_bk))return _bi;var _bp=[],_bq;for(var _br= -1;++_br<_bn;){
var _W=_bi[_br];if(_bq=_bk?_bs(_W,_bk):_f){for(var _bt in _bj){var _bu=_W[_bt],_bv=_bj[_bt],_bw=Uize.isFunction;if(!(_O[typeof _bv]?_bu==_bv:(_bv instanceof RegExp?_bv.test(_bu||''):(_bw(_bv)?_bv.call(_W,_bu):_f)))){_bq=_g;break;}}}_bq&&_bp.push(_W);}return _bp;};var _bx=_a.getCoords=function(_W){var _by=0,_bz=0,_bA=0,_bB=0,_bC=_f,_bD=_A(),_bE=_bF(window);function _bG(){_by+=_bD.scrollLeft;_bz+=_bD.scrollTop;}if(_W==window){_bG();_bA=_bE.width;_bB=_bE.height;}else if(_0(_W=_Z(_W))){_bA=_W.offsetWidth;_bB=_W.offsetHeight;if(!(_bA&&_bB)&&_W.tagName=='DIV'){for(var _bH=_W.childNodes,_bI=_bH.length;--_bI>=0;){if(_bH[_bI].nodeName.charAt(0)!='#'){var _bJ=_bx(_bH[_bI]);if(_bJ.width||_bJ.height){_bA=Math.max(_bA,_bJ.right-_by+1);_bB=Math.max(_bB,_bJ.bottom-_bz+1);}}}}function _bK(_W){return _bL(_W,'display')=='none'||_bL(_W,'visibility')==_i;}if(_W.tagName=='A'&&_W.childNodes.length==1&&_W.childNodes[0].tagName=='IMG')_W=_W.childNodes[0];var _bM=_bC= !_bK(_W),_bN=_W,_bO=_W;
while(_bO.parentNode&&typeof _bO.parentNode!='unknown'){var _bP=_bO.offsetLeft||0,_bQ=_bO.offsetTop||0,_bR=_bO.offsetWidth,_bS=_bO.offsetHeight;if(_bC&&_bK(_bO))_bC=_g;if(_bO==_bN){_by+=_bP+(parseInt(_bL(_bO,'borderLeftWidth'))||0);_bz+=_bQ+(parseInt(_bL(_bO,'borderTopWidth'))||0);_bN=_bO.offsetParent;_bL(_bO,'position')=='fixed'&&_bG();}if(_bO!=_W&&_bO!=document.body&&_bO!=document.documentElement&&(_bO.scrollWidth>_bR||_bO.scrollHeight>_bS)){_by-=_bO.scrollLeft;_bz-=_bO.scrollTop;if(_n){_by+=_bO.clientLeft;_bz+=_bO.clientTop;}if(_bC)_bC=_5(_by,_bz,_bA,_bB,_bP,_bQ,_bR,_bS);}_bO=_bO.parentNode;}if(_bC)_bC=_5(_by,_bz,_bA,_bB,_bD.scrollLeft,_bD.scrollTop,_bE.width,_bE.height);}return{x:_by,y:_bz,width:_bA,height:_bB,area:_bA*_bB,left:_by,top:_bz,right:_by+_bA-1,bottom:_bz+_bB-1,seen:_bC};};var _bF=_a.getDimensions=function(_W){if(_W==window){var _bD=document.documentElement;return{width:_bD.clientWidth||window.innerWidth||_bD.offsetWidth,height:_bD.clientHeight||window.innerHeight||_bD.offsetHeight};
}else if(_W=_Z(_W)){return{width:_W.offsetWidth||parseInt(_bL(_W,'width'))||0,height:_W.offsetHeight||parseInt(_bL(_W,'height'))||0};}else{return{width:0,height:0};}};var _bT={borderColor:['border','Color'],borderWidth:['border','Width'],padding:1,margin:1},_bL=_a.getStyle=function(_W,_bU){var _bV='';if(typeof _bU==_c){if(_W){var _bW=_n&&_bU=='opacity',_bX=document.defaultView,_bY=_bX&&_bX.getComputedStyle(_W,'');if(_bW)_bU='filter';if(_bY){if(!(_bV=_bY[_bU])){var _bZ=_bT[_bU];if(_bZ){var _b0=_bZ[0]||_bU,_b1=_bZ[1]||'',_b2=_bY[_b0+'Top'+_b1],_b3=_bY[_b0+'Right'+_b1],_b4=_bY[_b0+'Bottom'+_b1],_b5=_bY[_b0+'Left'+_b1];_bV=_b2==_b3&&_b3==_b4&&_b4==_b5?_b5:_b2+' '+_b3+' '+_b4+' '+_b5;}}}else{var _b6=_W.currentStyle;_bV=_b6?_b6.getAttribute(_bU):_W.style[_bU];}if(_bW){var _b7=(_bV||'').match(/alpha\s*\(\s*opacity\s*=([^\)]*)\)/i);_bV=_b7?_b7[1]/100:1;}}}else{_bV={};if(_W)for(_bU in _bU)_bV[_bU]=_bL(_W,_bU);}return _bV;};var _b8=_a.getText=function(_W){var _b9='';if(_W=_Z(_W)){function _ca(_W){
if(typeof _W.innerText==_c){_b9+=_W.innerText.replace(/\r|\n|\r\n/g,'');}else if(typeof _W.textContent==_c){_b9+=_W.textContent;}else{if(_W.nodeType==3)_b9+=_W.data;if(_W.childNodes){for(var _bI= -1,_bH=_W.childNodes,_cb=_bH.length;++_bI<_cb;)_b8(_bH[_bI]);}}}_ca(_W);}return _b9;};_a.getValue=function(_W){var _bV;if(_W=_Z(_W)){if(_0(_W)){var _cc=_W.tagName;if(_cc=='TEXTAREA'){_bV=_W.value;}else if(_cc=='INPUT'){_bV=_W.type=='checkbox'?_W.checked:_W.value;}else if(_cc=='SELECT'){if(_W.multiple){_bV=[];for(var _cd= -1,_ce=_W.options,_cf=_ce.length,_cg;++_cd<_cf;)(_cg=_ce[_cd]).selected&&_bV.push(_cg.value);}else{_bV=_W.value;}}else if(_cc=='IMG'){_bV=_W.src;}else{_bV=_W.innerHTML.replace(/<br\/?>/gi,'\n').replace(/&nbsp;/g,' ');}}else{_bV=(Uize.findRecord(_W,{tagName:'INPUT',type:'radio',checked:_f})||{}).value;}}return _bV;};_a.injectHtml=function(_T,_ch,_ci){var _cj,_ck,_cl,_cm,_cn,_co;((_cj=_ci=='inner replace')||(_ck=_ci=='outer replace')||(_cl=_ci=='inner top')||(_cm=_ci=='outer top')||
(_cn=_ci=='outer bottom')||(_co=_f));_ch+='';_V(_T,function(_W){var _cp=_W.childNodes;function _cq(_cr){return _cr&&/<script/i.test(_cr);}function _cs(){return _cq(_ch);}if((_cj||(!_cp.length&&(_cl||_co)))&& !_cs()){_W.innerHTML=_ch;}else if(_ck&&_n&& !_cs()){_W.outerHTML=_ch;}else{if(_cj)_W.innerHTML='';var _ct=document.createElement('DIV');_ct.innerHTML=_ch;var _cu=_cl?_cp[0]:_cn?_W.nextSibling:_W,_cv=_ct.childNodes,_cw=_W.parentNode;function _cx(_W){if(_W.tagName=='SCRIPT'){var _cy=document.createElement('script');if(_W.id)_cy.id=_W.id;if(_W.type)_cy.type=_W.type;_cy.text=_W.text;if(_W.src)_cy.src=_W.src;_W.parentNode.replaceChild(_cy,_W);}else if(_cq(_W.innerHTML)){for(var _bI= -1,_cp=_W.childNodes,_cz=_cp.length;++_bI<_cz;)_cx(_cp[_bI]);}}while(_cv.length){var _cA=_cv[0];if(_co||_cj){_W.appendChild(_cA);}else if(_cl){_cu?_W.insertBefore(_cA,_cu):_W.appendChild(_cA);}else if(_cm||_ck){_cw.insertBefore(_cA,_cu);}else if(_cn){_cu?_cw.insertBefore(_cA,_cu):_cw.appendChild(_cA);}_cx(_cA);}
_ck&&_cw.removeChild(_W);}});};var _0=_a.isNode=function(_W){return!!(_W&&typeof _W==_d&&(_W.getAttribute||_W.documentElement||(_W.self&&_W.self==_W)));};var _bs=_a.isOnNodeTree=function(_W,_cB){_W=_Z(_W);_cB=_Z(_cB);while(_W){if(_W==_cB)return _f;_W=_W.parentNode;}return _g;};var _bf=_a.joinIdPrefixAndNodeId=function(_X,_y){return(_X||'')+(_X&&_y?'-':'')+_y;};_a.remove=function(_T){_V(_T,function(_W){_W.parentNode.removeChild(_W)});};_a.setClipRect=function(_T,_b2,_b3,_b4,_b5){var _cC='rect('+_b2+'px, '+_b3+'px, '+_b4+'px, '+_b5+'px)';_V(_T,function(_W){_W.style.clip=_cC});};var _cD=['left','top','width','height'];_a.setCoords=function(_T,_cE){_cF(_T,typeof _cE.length=='number'?_G(_cD,_cE):_cE);};_a.centerInWindow=function(_T){var _cG=_bx(window);_V(_T,function(_W){var _cH=_bF(_W);_a.setCoords(_W,{left:_cG.x+((_cG.width-_cH.width)>>1),top:_cG.y+((_cG.height-_cH.height)>>1)});});};_a.getEventAbsPos=function(_cI){var _cJ=(_cI||(_cI=_w)).targetTouches;if(_cJ&&_cJ.length)_cI=_cJ[0];if(_cI.pageX!=_b){
return{left:_cI.pageX,top:_cI.pageY};}else{var _bD=_A();return{left:_cI.clientX+_bD.scrollLeft,top:_cI.clientY+_bD.scrollTop};}};var _cK=_a.setAbsPos=function(_T,_cL,_cM){_cM=typeof _cM=='number'?{x:_cM,y:_cM}:(_cM||{x:0,y:0});var _bD=document[_o?'body':'documentElement'],_cN=_bF(window);_V(_T,function(_W){function _cO(_cP,_cQ,_cR,_cS){var _cT=_cL[_cP],_cU=_cM[_cS],_cV=_cT-_bD[_cQ],_cW=_cU+_cH[_cR];return(_cT+(_cV+_cW>_cN[_cR]?Math.max(-_cW,-_cV):_cU));}var _cH=_bF(_W);_cF(_W,{left:_cO('left','scrollLeft','width','x'),top:_cO('top','scrollTop','height','y'),right:'auto',bottom:'auto'});});};_a.setAbsPosAdjacentTo=function(_T,_cX,_cY){_cX=_Z(_cX);var _cZ=_bx(_cX),_c0=_cZ.width/2,_c1=_cZ.height/2,_c2=_cY=='x'? -1:1;if(!_c0&& !_c1)_cZ=_a.getEventAbsPos();_V(_T,function(_W){_cK(_W,{left:_cZ.left+_c0,top:_cZ.top+_c1},{x:-_c0*_c2,y:_c1*_c2});});};_a.setInnerHtml=function(_T,_cr){_cr+='';_V(_T,function(_W){_W.innerHTML=_cr});};var _c3={};_a.setOpacity=function(_T,_c4){_c3.opacity=_c4;_cF(_T,_c3);};
_a.setProperties=function(_T,_bg){_V(_T,function(_W){_j(_W,_bg)});};var _cF=_a.setStyle=function(_T,_bg){_V(_T,function(_W){var _c5=_W.style,_c6;if(_n&&'opacity'in _bg)_c5.filter=(_c6=Math.round(_bg.opacity*100))<100?'alpha(opacity='+_c6+')':'';for(var _bU in _bg)_c5[_bU]=(typeof(_c6=_bg[_bU])==_d&&_c6?(_c6=_c6.valueOf()):_c6)!=_b?(typeof _c6=='number'&&_bU!='opacity'&&_bU!='zIndex'?Math.round(_c6)+'px':_c6+''):'';});};_a.setValue=function(_T,_bV){_bV+='';_V(_T,function(_W){var _cc=_W.tagName,_c7=_W.readOnly;if(_c7)_W.readOnly=_g;if(_cc=='TEXTAREA'){_W.value=_bV;}else if(_cc=='INPUT'){var _c8=_W.type;if(_c8=='text'||_c8==_i||_c8=='password'){_W.value=_bV;}else if(_c8=='checkbox'){_W.checked=_bV=='true';}else if(_c8=='radio'){_W.checked=_W.value==_bV;}}else if(_cc=='SELECT'){if(!_bV){_W.selectedIndex= -1;}else{var _ce=_W.options;if(_W.multiple&&(_bV=='*'||_bV.indexOf(',')> -1)){var _c9;if(_bV!='*'){_c9={};for(var _I=_bV.split(','),_J=_I.length;--_J>=0;)_c9[_I[_J]]=1;}for(var _cd=_ce.length,_cg;--_cd>=0;)
(_cg=_ce[_cd]).selected= !_c9||_c9[_cg.value];}else{_W.selectedIndex=Uize.findRecordNo(_ce,{value:_bV},_W.selectedIndex);}}}else if(_cc=='IMG'){if(_bV)_W.src=_bV;}else{_cc=='PRE'&&_n?(_W.innerText=_bV):(_W.innerHTML=_bV.replace(/</g,'&lt;').replace(/\n/g,'<br/>'));}if(_c7)_W.readOnly=_c7;});};_a.show=function(_T,_da){_cF(_T,{visibility:_da||_da===_b?'inherit':_i});};_a.showClickable=function(_T,_db){_cF(_T,{cursor:_db||_db===_b?(_t?'hand':'pointer'):'default'});};var _dc=_a.unwire=function(_T,_dd,_de,_df){if(typeof _dd==_d&&_dd&& !_dd.virtualDomEvent){for(var _F in _dd)_dc(_T,_F,_dd[_F],_de);}else{_a.unwireEventsByOwnerId(_df,_T!==_b||_dd!=_b||_de!=_b?{node:_T,eventName:_dd,handler:_de}:_b);}};_a.unwireEventsByOwnerId=function(_dg,_dh){var _di=_M[_dg=_dg||''];if(_di){function _dj(_dk){if(_dk!==_h){var _dl=_dh&&_dh.eventName,_dm=_dh&&_dh.handler,_dn=_dk||_dl||_dm;if(_dl&&_dl.charCodeAt)_dl=_E(_dl);for(var _do=_di.length;--_do>=0;){var _dp=_di[_do],_dq=_L[_dp],_W=_dq._W,_F=_dq._F;if(!_dn||(
(!_dk||_dk==(_dq._dr||_W))&&(!_dl||_dl==_F)&&(!_dm||_dm==_dq._ds))){_dn&&_di.splice(_do,1);if(_dq._dt){_a.unwireEventsByOwnerId(_dq._dt)}else{try{_W==window?_du.unwire(_F,_dq._dv):_n?_W.detachEvent('on'+_F,_dq._dv):_W.removeEventListener(_F,_dq._dv,_g);}catch(_dw){}}delete _L[_dp];}}(_dn&&_di.length)||delete _M[_dg];}}_dh&&_dh.node!==_b?_V(_dh.node,_dj):_dj();}};var _dx=_B(function(_dp){return(function(_v){var _dq=window.Uize&&Uize.Node._L[_dp];return _dq&&_dq._ds.call(_dq._W,_v.windowEvent);});}),_dy=_B(function(_dp){return(function(_v){var _dq=window.Uize&&Uize.Node._L[_dp];return _dq&&_dq._ds.call(_dq._W,_v||window.event);});}),_dz={click:_dy,mouseover:_B(function(_dp){return(function(_v){var _dq=window.Uize&&Uize.Node._L[_dp],_dA=(_v||(_v=window.event)).fromElement||_v.relatedTarget;if(_dq){if(_dA){try{if(!_dA.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dA,_dq._W))_dA=null;}catch(_dw){_dA=null;}}if(!_dA){Uize.Node._u(_v);return _dq._ds.call(_dq._W,_v);}}});}),mouseout:_B(function(_dp){return(
function(_v){var _dq=window.Uize&&Uize.Node._L[_dp],_dB=(_v||(_v=window.event)).toElement||_v.relatedTarget;if(_dq){if(_dB){try{if(!_dB.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dB,_dq._W))_dB=null;}catch(_dw){_dB=null;}}if(!_dB)return _dq._ds.call(_dq._W,_v);}});}),mousedown:_dy,mouseup:_dy};_a.wire=function(_T,_F,_ds,_dg){if(!_F)return;if(_dg==_b)_dg='';var _dC;if(_F.charCodeAt)_F=_E(_F);if(typeof _F==_d&& !(_dC= !!_F.virtualDomEvent)){_dg=arguments[2]||'';for(var _v in _F)_a.wire(_T,_v,_F[_v],_dg);return;}_V(_T,function(_W){var _cc=_W.tagName;(_M[_dg]||(_M[_dg]=[])).push(_N);var _dv=(_dC?_a.returnFalse:_W==window?_dx:_dz[_F]||_dy)(_N);var _dq=_L[_N++]={_W:_W,_F:_F,_ds:_ds,_dv:_dv};if(_r&&_cc=='BODY'&&_F=='scroll'){_dq._dr=_W;_W=_dq._W=document;}if(_dv){var _dD='on'+_F;_W==window?_du.wire(_F,_dv):_n?_W.attachEvent(_dD,_dv):_W.addEventListener(_F,_dv,_g);if(_cc=='A'&&(_F=='mousedown'||_F=='click')&& !_W[_dD])_W[_dD]=_a.returnFalse;}else if(_dC){_F.wire(_W,_ds,_dq._dt=Uize.getGuid());}});};
_a.returnFalse=new Function('return false');_a.returnTrue=new Function('return true');_a.ieMajorVersion=_s;_a.isIe=_n;_a.isSafari=_o;_a.isMozilla=_p;if(_k){_a.wire(document.documentElement,'mousemove',_u);var _du=new Uize,_dE=setTimeout(function(){_du.fire('load')},15000);function _dF(_dG){var _dH='on'+_dG,_dI=window[_dH]||_a.returnFalse;window[_dH]=function(_v){_dG=='load'&&clearTimeout(_dE);_dI.call(window,_v||(_v=window.event));_du.fire({name:_dG,windowEvent:_v});};}for(var _dG in{focus:1,blur:1,load:1,beforeunload:1,unload:1,resize:1,scroll:1})_dF(_dG);;}return _a;}});