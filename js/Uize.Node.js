/*
	UIZE JAVASCRIPT FRAMEWORK 2011-11-18

	http://www.uize.com/reference/Uize.Node.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Node',builder:function(){var _a=function(){},_b,_c='string',_d='object',_e='function',_f=true,_g=false,_h=null,_i='hidden',_j=Uize.copyInto,_k=Uize.isPrimitive;var _l=typeof navigator!='undefined',_m=_l?navigator:{userAgent:'',appName:''},_n=_m.userAgent.toLowerCase(),_o=_m.appName=='Microsoft Internet Explorer',_p={TABLE:_f,THEAD:_f,TFOOT:_f,TBODY:_f,TR:_f,COL:_f,COLGRPUP:_f,FRAMESET:_f,HEAD:_f,HTML:_f,STYLE:_f,TITLE:_f},_q=_n.indexOf('applewebkit')> -1,_r=_n.indexOf('gecko')> -1,_s=_n.indexOf('opera')> -1,_t=_r||_s,_u= +(_o&&(_n.match(/MSIE\s*(\d+)/i)||[0,0])[1]),_v=_o&&_u<9;var _w=_a._w=function(_x){_y.clientX=_x.clientX;_y.clientY=_x.clientY;_y.pageX=_x.pageX;_y.pageY=_x.pageY;};function _z(_A){var _B=document.getElementById(_A);return(!_o||(_B&&_B.id==_A))?_B:_h;}function _C(){return document[_q?'body':'documentElement'];}function _D(_E){var _F=(_E=_E+'').slice(_E.indexOf('(')+1,_E.indexOf(')'));return Function.apply({},(_F?_F.split(','):[]).concat(
_E.slice(_E.indexOf('{')+1,_E.lastIndexOf('}'))));}function _G(_H){if(_H.charCodeAt(0)==111&&_H.charCodeAt(1)==110)_H=_H.slice(2);return(_H.charCodeAt(_H.length-1)==41&&_a.VirtualEvent?_a.VirtualEvent.resolve(_H):_H);}function _I(_J,_K){for(var _L= -1,_B={},_M=Math.min(_J.length,_K.length);++_L<_M;)_B[_J[_L]]=_K[_L];return _B;}var _N=_a._N={},_O={},_P=0,_y={clientX:0,clientY:0,pageX:0,pageY:0};var _Q='table-',_R=_Q+'row',_S=_Q+'cell',_T=_j({SPAN:'inline',THEAD:_Q+'header-group',TFOOT:_Q+'footer-group',LI:'list-item'},_o&&typeof DOMImplementation=='undefined'?_h:{TABLE:'table',TR:_R,TH:_S,TD:_S,TBODY:_R+'-group',COLGROUP:_Q+'column-group',COL:_Q+'column',CAPTION:_Q+'caption'});_a.display=function(_U,_V){_V=_V===_b|| !!_V;_W(_U,function(_X){_X.style.display=_V?(_T[_X.tagName]||'block'):'none';});};var _W=_a.doForAll=function(_U,_E,_Y,_Z){if(typeof _U==_c)_U=_0(_U,_Y,_Z);if(_U!=_b){if(_1(_U)){_E(_U);}else{var _2=typeof _U;if((_2==_d||_2==_e)&&typeof _U.length=='number'){for(var _3= -1,_4=_U.length;++_3<_4;)
_W(_U[_3],_E,_Y,_Z);}else if(_2==_d){for(var _5 in _U)_W(_U[_5],_E,_Y,_Z);}}}};var _6=_a.doRectanglesOverlap=function(_7,_8,_9,_ba,_bb,_bc,_bd,_be){return(_9-1+ +_7>=_bb&&_bd-1+ +_bb>=_7&&_ba-1+ +_8>=_bc&&_be-1+ +_bc>=_8);};var _0=_a.getById=function(_X,_Y,_Z){if(typeof _X!=_c)return _X;var _B=_Z?_Z[_X]:_b;if(_B===_b){var _bf=_bg(_Y,_X);(_B=_z(_bf))||(((_B=document.getElementsByName(_bf)).length<2)&&(_B=_B[0]||_h));if(_Z)_Z[_X]=_B;}return _B;};_a.find=function(_bh){if(typeof _bh!=_d|| !_bh||typeof _bh.length=='number'||_1(_bh))return _bh;var _bi=document,_bj=[],_bk=_j({},_bh),_bl='root'in _bk?_0(_bk.root):_bi;delete _bk.root;if(_bl){var _bm=_bk.tagName;if('id'in _bk&&_k(_bk.id)){var _X=_z(_bk.id);_X&&_bj.push(_X);delete _bk.id;}else if('name'in _bk&&_k(_bk.name)){_bj=_bi.getElementsByName(_bk.name);delete _bk.name;}else{var _bn=_k(_bm);_bn&&delete _bk.tagName;_bj=_bl.getElementsByTagName(_bm&&_bn?_bm:'*');_bl=_h;}if(_bl==_bi)_bl=_h;if(!_bm||_bm=='*')delete _bk.tagName;}var _bo=_bj.length;
for(var _bp in _bk)break;if(!_bo||(_bp==_b&& !_bl))return _bj;var _bq=[],_br;for(var _bs= -1;++_bs<_bo;){var _X=_bj[_bs];if(_br=_bl?_bt(_X,_bl):_f){for(var _bu in _bk){var _bv=_X[_bu],_bw=_bk[_bu],_bx=Uize.isFunction;if(!(_k(_bw)?_bv==_bw:(_bw instanceof RegExp?_bw.test(_bv||''):(_bx(_bw)?_bw.call(_X,_bv):_f)))){_br=_g;break;}}}_br&&_bq.push(_X);}return _bq;};var _by=_a.getCoords=function(_X){var _bz=0,_bA=0,_bB=0,_bC=0,_bD=_f,_bE=100,_bF=_C(),_bG=_bH(window);function _bI(){_bz+=_bF.scrollLeft;_bA+=_bF.scrollTop;}if(_X==window){_bI();_bB=_bG.width;_bC=_bG.height;}else if(_1(_X=_0(_X))){_bB=_X.offsetWidth;_bC=_X.offsetHeight;if(!(_bB&&_bC)&&_X.tagName=='DIV'){for(var _bJ=_X.childNodes,_bK=_bJ.length;--_bK>=0;){if(_bJ[_bK].nodeName.charAt(0)!='#'){var _bL=_by(_bJ[_bK]);if(_bL.width||_bL.height){_bB=Math.max(_bB,_bL.right-_bz+1);_bC=Math.max(_bC,_bL.bottom-_bA+1);}}}}function _bM(_X){return _bN(_X,'display')=='none'||_bN(_X,'visibility')==_i;}
if(_X.tagName=='A'&&_X.childNodes.length==1&&_X.childNodes[0].tagName=='IMG')_X=_X.childNodes[0];var _bO=_bD= !_bM(_X),_bP=_X,_bQ=_X,_bR=_bG.width,_bS=_bG.height,_bT=_bF.scrollLeft,_bU=_bF.scrollTop,_bV=_bT+_bR,_bW=_bU+_bS;while(_bQ.parentNode&&typeof _bQ.parentNode!='unknown'){var _bX=_bQ.offsetLeft||0,_bY=_bQ.offsetTop||0,_bZ=_bQ.offsetWidth,_b0=_bQ.offsetHeight;if(_bD&&_bM(_bQ))_bD=_g;if(_bQ==_bP){_bz+=_bX+(parseInt(_bN(_bQ,'borderLeftWidth'))||0);_bA+=_bY+(parseInt(_bN(_bQ,'borderTopWidth'))||0);_bP=_bQ.offsetParent;_bN(_bQ,'position')=='fixed'&&_bI();}if(_bQ!=_X&&_bQ!=document.body&&_bQ!=document.documentElement&&(_bQ.scrollWidth>_bZ||_bQ.scrollHeight>_b0)){_bz-=_bQ.scrollLeft;_bA-=_bQ.scrollTop;if(_o){_bz+=_bQ.clientLeft;_bA+=_bQ.clientTop;}if(_bD)_bD=_6(_bz,_bA,_bB,_bC,_bX,_bY,_bZ,_b0);}_bQ=_bQ.parentNode;}if(_bD)_bD=_6(_bz,_bA,_bB,_bC,_bT,_bU,_bR,_bS);_bE=_bD?((Math.min(_bz+_bB,_bV)-Math.min(Math.max(_bz,_bT),_bV))*(Math.min(_bA+_bC,_bW)-Math.min(Math.max(_bA,_bU),_bW)))/(_bB*_bC)*100:0;}return{x:_bz,
y:_bA,width:_bB,height:_bC,area:_bB*_bC,left:_bz,top:_bA,right:_bz+_bB-1,bottom:_bA+_bC-1,seen:_bD,percentSeen:_bE};};var _bH=_a.getDimensions=function(_X){if(_X==window){var _bF=document.documentElement;return{width:_bF.clientWidth||window.innerWidth||_bF.offsetWidth,height:_bF.clientHeight||window.innerHeight||_bF.offsetHeight};}else if(_X=_0(_X)){return{width:_X.offsetWidth||parseInt(_bN(_X,'width'))||0,height:_X.offsetHeight||parseInt(_bN(_X,'height'))||0};}else{return{width:0,height:0};}};var _b1={borderColor:['border','Color'],borderWidth:['border','Width'],padding:1,margin:1},_bN=_a.getStyle=function(_X,_b2){var _b3='';if(typeof _b2==_c){if(_X){var _b4=_o&&_b2=='opacity',_b5=document.defaultView,_b6=_b5&&_b5.getComputedStyle(_X,'');if(_b4)_b2='filter';if(_b6){if(!(_b3=_b6[_b2])){var _b7=_b1[_b2];if(_b7){var _b8=_b7[0]||_b2,_b9=_b7[1]||'',_ca=_b6[_b8+'Top'+_b9],_cb=_b6[_b8+'Right'+_b9],_cc=_b6[_b8+'Bottom'+_b9],_cd=_b6[_b8+'Left'+_b9];_b3=_ca==_cb&&_cb==_cc&&_cc==_cd?_cd:_ca+' '+_cb+' '+_cc+' '+_cd;}}
}else{var _ce=_X.currentStyle;_b3=_ce?_ce.getAttribute(_b2):_X.style[_b2];}if(_b4){var _cf=(_b3||'').match(/alpha\s*\(\s*opacity\s*=([^\)]*)\)/i);_b3=_cf?_cf[1]/100:1;}}}else{_b3={};if(_X)for(_b2 in _b2)_b3[_b2]=_bN(_X,_b2);}return _b3;};var _cg=_a.getText=function(_X){var _ch='';if(_X=_0(_X)){function _ci(_X){if(typeof _X.innerText==_c){_ch+=_X.innerText.replace(/\r|\n|\r\n/g,'');}else if(typeof _X.textContent==_c){_ch+=_X.textContent;}else{if(_X.nodeType==3)_ch+=_X.data;_X.childNodes&&Uize.forEach(_X.childNodes,_ci);}}_ci(_X);}return _ch;};_a.getValue=function(_X){var _b3;if(_X=_0(_X)){if(_1(_X)){var _cj=_X.tagName;if(_cj=='TEXTAREA'){_b3=_X.value;}else if(_cj=='INPUT'){_b3=_X.type=='checkbox'?_X.checked:_X.value;}else if(_cj=='SELECT'){if(_X.multiple){_b3=[];Uize.forEach(_X.options,function(_ck){_ck.selected&&_b3.push(_ck.value)});}else{_b3=_X.value;}}else if(_cj=='IMG'){_b3=_X.src;}else{_b3=_X.innerHTML.replace(/<br\/?>/gi,'\n').replace(/&nbsp;/g,' ');}}else{
_b3=(Uize.findRecord(_X,{tagName:'INPUT',type:'radio',checked:_f})||{}).value;}}return _b3;};_a.injectHtml=function(_U,_cl,_cm){var _cn,_co,_cp,_cq,_cr,_cs,_ct=Uize.isArray(_cl)||(_1(_cl)&&(_cl=[_cl]));((_cn=_cm=='inner replace')||(_co=_cm=='outer replace')||(_cp=_cm=='inner top')||(_cq=_cm=='outer top')||(_cr=_cm=='outer bottom')||(_cs=_f));_ct||(_cl+='');_W(_U,function(_X){var _cu=_X.childNodes;function _cv(_cw){return _cw&&/<script/i.test(_cw)}function _cx(){return _cv(_cl)}if((_cn||(!_cu.length&&(_cp||_cs)))&& !_1&& !_cx()){_X.innerHTML=_cl;}else if(_co&&_o&& !_1&& !_cx()){_X.outerHTML=_cl;}else{if(_cn)if(_o&&_p[_X.tagName]){var _cy=_X.cloneNode();_X.replaceNode(_cy);_X=_cy;}else _X.innerHTML='';if(_ct){var _cz=[];for(var _bs= -1,_cA=_cl.length;++_bs<_cA;)_cz.push(_cl[_bs].cloneNode(_f));}else{var _cB=document.createElement('DIV');_cB.innerHTML='<i>e</i>'+_cl;var _cz=_cB.childNodes}var _cC=_cp?_cu[0]:_cr?_X.nextSibling:_X,_cD=_X.parentNode,_cE= +!_ct;function _cF(_X){if(_X.tagName=='SCRIPT'){
var _cG=document.createElement('script');if(_X.id)_cG.id=_X.id;if(_X.type)_cG.type=_X.type;_cG.text=_X.text;if(_X.src)_cG.src=_X.src;_X.parentNode.replaceChild(_cG,_X);}else if(_cv(_X.innerHTML)){Uize.forEach(_X.childNodes,_cF);}}while(_cz.length>_cE){var _cH=_ct?_cz.shift():_cz[_cE];if(_cs||_cn){_X.appendChild(_cH);}else if(_cp){_cC?_X.insertBefore(_cH,_cC):_X.appendChild(_cH);}else if(_cq||_co){_cD.insertBefore(_cH,_cC);}else if(_cr){_cC?_cD.insertBefore(_cH,_cC):_cD.appendChild(_cH);}_ct||_cF(_cH);}_co&&_cD.removeChild(_X);}});};var _1=_a.isNode=function(_X){return!!(_X&&typeof _X==_d&&(_X.getAttribute||_X.documentElement||(_X.self&&_X.self==_X)));};var _bt=_a.isOnNodeTree=function(_X,_cI){_X=_0(_X);_cI=_0(_cI);while(_X){if(_X==_cI)return _f;_X=_X.parentNode;}return _g;};var _bg=_a.joinIdPrefixAndNodeId=function(_Y,_A){return(_Y||'')+(_Y&&_A?'-':'')+_A;};_a.remove=function(_U){_W(_U,function(_X){_X.parentNode.removeChild(_X)});};_a.setClipRect=function(_U,_ca,_cb,_cc,_cd){
var _cJ='rect('+_ca+'px, '+_cb+'px, '+_cc+'px, '+_cd+'px)';_W(_U,function(_X){_X.style.clip=_cJ});};var _cK=['left','top','width','height'];_a.setCoords=function(_U,_cL){_cM(_U,typeof _cL.length=='number'?_I(_cK,_cL):_cL);};_a.centerInWindow=function(_U){var _cN=_by(window);_W(_U,function(_X){var _cO=_bH(_X);_a.setCoords(_X,{left:_cN.x+((_cN.width-_cO.width)>>1),top:_cN.y+((_cN.height-_cO.height)>>1)});});};_a.getEventAbsPos=function(_cP){var _cQ=(_cP||(_cP=_y)).targetTouches;if(_cQ&&_cQ.length)_cP=_cQ[0];if(_cP.pageX!=_b){return{left:_cP.pageX,top:_cP.pageY};}else{var _bF=_C();return{left:_cP.clientX+_bF.scrollLeft,top:_cP.clientY+_bF.scrollTop};}};var _cR=_a.setAbsPos=function(_U,_cS,_cT){_cT=typeof _cT=='number'?{x:_cT,y:_cT}:(_cT||{x:0,y:0});var _bF=document[_q?'body':'documentElement'],_cU=_bH(window);_W(_U,function(_X){function _cV(_cW,_cX,_cY,_cZ){var _c0=_cS[_cW],_c1=_cT[_cZ],_c2=_c0-_bF[_cX],_c3=_c1+_cO[_cY];return(_c0+(_c2+_c3>_cU[_cY]?Math.max(-_c3,-_c2):_c1));}var _cO=_bH(_X);_cM(_X,{
left:_cV('left','scrollLeft','width','x'),top:_cV('top','scrollTop','height','y'),right:'auto',bottom:'auto'});});};_a.setAbsPosAdjacentTo=function(_U,_c4,_c5){_c4=_0(_c4);var _c6=_by(_c4),_c7=_c6.width/2,_c8=_c6.height/2,_c9=_c5=='x'? -1:1;if(!_c7&& !_c8)_c6=_a.getEventAbsPos();_W(_U,function(_X){_cR(_X,{left:_c6.left+_c7,top:_c6.top+_c8},{x:-_c7*_c9,y:_c8*_c9});});};_a.setInnerHtml=function(_U,_cw){_cw+='';_W(_U,function(_X){_X.innerHTML=_cw});};var _da={};_a.setOpacity=function(_U,_db){_da.opacity=_db;_cM(_U,_da);};_a.setProperties=function(_U,_bh){_W(_U,function(_X){_j(_X,_bh)});};var _cM=_a.setStyle=function(_U,_bh){_W(_U,function(_X){var _dc=_X.style,_dd;if(_o&&'opacity'in _bh)_dc.filter=(_dd=Math.round(_bh.opacity*100))<100?'alpha(opacity='+_dd+')':'';for(var _b2 in _bh)_dc[_b2]=(typeof(_dd=_bh[_b2])==_d&&_dd?(_dd=_dd.valueOf()):_dd)!=_b?(typeof _dd=='number'&&_b2!='opacity'&&_b2!='zIndex'?Math.round(_dd)+'px':_dd+''):'';});};_a.setValue=function(_U,_b3){_b3+='';_W(_U,function(_X){var _cj=_X.tagName,
_de=_X.readOnly;if(_de)_X.readOnly=_g;if(_cj=='TEXTAREA'){_X.value=_b3;}else if(_cj=='INPUT'){var _df=_X.type;if(_df=='text'||_df==_i||_df=='password'){_X.value=_b3;}else if(_df=='checkbox'){_X.checked=_b3=='true';}else if(_df=='radio'){_X.checked=_X.value==_b3;}}else if(_cj=='SELECT'){if(!_b3){_X.selectedIndex= -1;}else{var _dg=_X.options;if(_X.multiple&&(_b3=='*'||_b3.indexOf(',')> -1)){var _dh=_b3!='*'?Uize.lookup(_b3.split(',')):_b;for(var _di=_dg.length,_ck;--_di>=0;)(_ck=_dg[_di]).selected= !_dh||_dh[_ck.value];}else{_X.selectedIndex=Uize.findRecordNo(_dg,{value:_b3},_X.selectedIndex);}}}else if(_cj=='IMG'){if(_b3)_X.src=_b3;}else{_cj=='PRE'&&_o?(_X.innerText=_b3):(_X.innerHTML=_b3.replace(/</g,'&lt;').replace(/\n/g,'<br/>'));}if(_de)_X.readOnly=_de;});};_a.show=function(_U,_dj){_cM(_U,{visibility:_dj||_dj===_b?'inherit':_i});};_a.showClickable=function(_U,_dk){_cM(_U,{cursor:_dk||_dk===_b?(_v?'hand':'pointer'):'default'});};var _dl=_a.unwire=function(_U,_dm,_dn,_do){if(typeof _dm==_d&&_dm&&
 !_dm.virtualDomEvent){for(var _H in _dm)_dl(_U,_H,_dm[_H],_dn);}else{_a.unwireEventsByOwnerId(_do,_U!==_b||_dm!=_b||_dn!=_b?{node:_U,eventName:_dm,handler:_dn}:_b);}};_a.unwireEventsByOwnerId=function(_dp,_dq){var _dr=_O[_dp=_dp||''];if(_dr){function _ds(_dt){if(_dt!==_h){var _du=_dq&&_dq.eventName,_dv=_dq&&_dq.handler,_dw=_dt||_du||_dv;if(_du&&_du.charCodeAt)_du=_G(_du);for(var _dx=_dr.length;--_dx>=0;){var _dy=_dr[_dx],_dz=_N[_dy],_X=_dz._X,_H=_dz._H;if(!_dw||((!_dt||_dt==(_dz._dA||_X))&&(!_du||_du==_H)&&(!_dv||_dv==_dz._dB))){_dw&&_dr.splice(_dx,1);if(_dz._dC){_a.unwireEventsByOwnerId(_dz._dC)}else{try{_X==window?_dD.unwire(_H,_dz._dE):_o?_X.detachEvent('on'+_H,_dz._dE):_X.removeEventListener(_H,_dz._dE,_g);}catch(_dF){}}delete _N[_dy];}}(_dw&&_dr.length)||delete _O[_dp];}}_dq&&_dq.node!==_b?_W(_dq.node,_ds):_ds();}};var _dG=_D(function(_dy){return(function(_x){var _dz=window.Uize&&Uize.Node._N[_dy];return _dz&&_dz._dB.call(_dz._X,_x.windowEvent);});}),_dH=_D(function(_dy){return(function(_x){
var _dz=window.Uize&&Uize.Node._N[_dy];return _dz&&_dz._dB.call(_dz._X,_x||window.event);});}),_dI={click:_dH,mouseover:_D(function(_dy){return(function(_x){var _dz=window.Uize&&Uize.Node._N[_dy],_dJ=(_x||(_x=window.event)).fromElement||_x.relatedTarget;if(_dz){if(_dJ){try{if(!_dJ.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dJ,_dz._X))_dJ=null;}catch(_dF){_dJ=null;}}if(!_dJ){Uize.Node._w(_x);return _dz._dB.call(_dz._X,_x);}}});}),mouseout:_D(function(_dy){return(function(_x){var _dz=window.Uize&&Uize.Node._N[_dy],_dK=(_x||(_x=window.event)).toElement||_x.relatedTarget;if(_dz){if(_dK){try{if(!_dK.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dK,_dz._X))_dK=null;}catch(_dF){_dK=null;}}if(!_dK)return _dz._dB.call(_dz._X,_x);}});}),mousedown:_dH,mouseup:_dH};_a.wire=function(_U,_H,_dB,_dp){if(!_H)return;if(_dp==_b)_dp='';var _dL;if(_H.charCodeAt)_H=_G(_H);if(typeof _H==_d&& !(_dL= !!_H.virtualDomEvent)){_dp=arguments[2]||'';for(var _x in _H)_a.wire(_U,_x,_H[_x],_dp);return;}_W(_U,function(_X){
var _cj=_X.tagName;(_O[_dp]||(_O[_dp]=[])).push(_P);var _dE=(_dL?_a.returnFalse:_X==window?_dG:_dI[_H]||_dH)(_P);var _dz=_N[_P++]={_X:_X,_H:_H,_dB:_dB,_dE:_dE};if(_t&&_cj=='BODY'&&_H=='scroll'){_dz._dA=_X;_X=_dz._X=document;}if(_dE){var _dM='on'+_H;_X==window?_dD.wire(_H,_dE):_o?_X.attachEvent(_dM,_dE):_X.addEventListener(_H,_dE,_g);if(_cj=='A'&&(_H=='mousedown'||_H=='click')&& !_X[_dM])_X[_dM]=_a.returnFalse;}else if(_dL){_H.wire(_X,_dB,_dz._dC=Uize.getGuid());}});};_a.returnFalse=new Function('return false');_a.returnTrue=new Function('return true');_a.ieMajorVersion=_u;_a.isIe=_o;_a.isSafari=_q;_a.isMozilla=_r;if(_l){_a.wire(document.documentElement,'mousemove',_w);var _dD=new Uize,_dN=setTimeout(function(){_dD.fire('load')},15000);Uize.forEach(['focus','blur','load','beforeunload','unload','resize','scroll'],function(_dO){var _dP='on'+_dO,_dQ=window[_dP]||_a.returnFalse;window[_dP]=function(_x){_dO=='load'&&clearTimeout(_dN);_dQ.call(window,_x||(_x=window.event));_dD.fire({name:_dO,windowEvent:_x});};});}
return _a;}});