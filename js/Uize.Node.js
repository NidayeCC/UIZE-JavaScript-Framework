/*
	UIZE JAVASCRIPT FRAMEWORK 2011-11-14

	http://www.uize.com/reference/Uize.Node.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Node',builder:function(){var _a=function(){},_b,_c='string',_d='object',_e='function',_f=true,_g=false,_h=null,_i='hidden',_j=Uize.copyInto,_k=Uize.isPrimitive;var _l=typeof navigator!='undefined',_m=_l?navigator:{userAgent:'',appName:''},_n=_m.userAgent.toLowerCase(),_o=_m.appName=='Microsoft Internet Explorer',_p={TABLE:_f,THEAD:_f,TFOOT:_f,TBODY:_f,TR:_f,COL:_f,COLGRPUP:_f,FRAMESET:_f,HEAD:_f,HTML:_f,STYLE:_f,TITLE:_f},_q=_n.indexOf('applewebkit')> -1,_r=_n.indexOf('gecko')> -1,_s=_n.indexOf('opera')> -1,_t=_r||_s,_u= +(_o&&(_n.match(/MSIE\s*(\d+)/i)||[0,0])[1]),_v=_o&&_u<9;var _w=_a._w=function(_x){_y.clientX=_x.clientX;_y.clientY=_x.clientY;_y.pageX=_x.pageX;_y.pageY=_x.pageY;};function _z(_A){var _B=document.getElementById(_A);return(!_o||(_B&&_B.id==_A))?_B:_h;}function _C(){return document[_q?'body':'documentElement'];}function _D(_E){var _F=(_E=_E+'').slice(_E.indexOf('(')+1,_E.indexOf(')'));return Function.apply({},(_F?_F.split(','):[]).concat(
_E.slice(_E.indexOf('{')+1,_E.lastIndexOf('}'))));}function _G(_H){if(_H.charCodeAt(0)==111&&_H.charCodeAt(1)==110)_H=_H.slice(2);return(_H.charCodeAt(_H.length-1)==41&&_a.VirtualEvent?_a.VirtualEvent.resolve(_H):_H);}function _I(_J,_K){for(var _L= -1,_B={},_M=Math.min(_J.length,_K.length);++_L<_M;)_B[_J[_L]]=_K[_L];return _B;}var _N=_a._N={},_O={},_P=0,_y={clientX:0,clientY:0,pageX:0,pageY:0};var _Q='table-',_R=_Q+'row',_S=_Q+'cell',_T=_j({SPAN:'inline',THEAD:_Q+'header-group',TFOOT:_Q+'footer-group',LI:'list-item'},_o&&typeof DOMImplementation=='undefined'?_h:{TABLE:'table',TR:_R,TH:_S,TD:_S,TBODY:_R+'-group',COLGROUP:_Q+'column-group',COL:_Q+'column',CAPTION:_Q+'caption'});_a.display=function(_U,_V){_V=_V===_b|| !!_V;_W(_U,function(_X){_X.style.display=_V?(_T[_X.tagName]||'block'):'none';});};var _W=_a.doForAll=function(_U,_E,_Y,_Z){if(typeof _U==_c)_U=_0(_U,_Y,_Z);if(_U!=_b){if(_1(_U)){_E(_U);}else{var _2=typeof _U;if((_2==_d||_2==_e)&&typeof _U.length=='number'){for(var _3= -1,_4=_U.length;++_3<_4;)
_W(_U[_3],_E,_Y,_Z);}else if(_2==_d){for(var _5 in _U)_W(_U[_5],_E,_Y,_Z);}}}};var _6=_a.doRectanglesOverlap=function(_7,_8,_9,_ba,_bb,_bc,_bd,_be){return(_9-1+ +_7>=_bb&&_bd-1+ +_bb>=_7&&_ba-1+ +_8>=_bc&&_be-1+ +_bc>=_8);};var _0=_a.getById=function(_X,_Y,_Z){if(typeof _X!=_c)return _X;var _B=_Z?_Z[_X]:_b;if(_B===_b){var _bf=_bg(_Y,_X);(_B=_z(_bf))||(((_B=document.getElementsByName(_bf)).length<2)&&(_B=_B[0]||_h));if(_Z)_Z[_X]=_B;}return _B;};_a.find=function(_bh){if(typeof _bh!=_d|| !_bh||typeof _bh.length=='number'||_1(_bh))return _bh;var _bi=document,_bj=[],_bk=_j({},_bh),_bl='root'in _bk?_0(_bk.root):_bi;delete _bk.root;if(_bl){var _bm=_bk.tagName;if('id'in _bk&&_k(_bk.id)){var _X=_z(_bk.id);_X&&_bj.push(_X);delete _bk.id;}else if('name'in _bk&&_k(_bk.name)){_bj=_bi.getElementsByName(_bk.name);delete _bk.name;}else{var _bn=_k(_bm);_bn&&delete _bk.tagName;_bj=_bl.getElementsByTagName(_bm&&_bn?_bm:'*');_bl=_h;}if(_bl==_bi)_bl=_h;if(!_bm||_bm=='*')delete _bk.tagName;}var _bo=_bj.length;
for(var _bp in _bk)break;if(!_bo||(_bp==_b&& !_bl))return _bj;var _bq=[],_br;for(var _bs= -1;++_bs<_bo;){var _X=_bj[_bs];if(_br=_bl?_bt(_X,_bl):_f){for(var _bu in _bk){var _bv=_X[_bu],_bw=_bk[_bu],_bx=Uize.isFunction;if(!(_k(_bw)?_bv==_bw:(_bw instanceof RegExp?_bw.test(_bv||''):(_bx(_bw)?_bw.call(_X,_bv):_f)))){_br=_g;break;}}}_br&&_bq.push(_X);}return _bq;};var _by=_a.getCoords=function(_X){var _bz=0,_bA=0,_bB=0,_bC=0,_bD=_f,_bE=100,_bF=_C(),_bG=_bH(window);function _bI(){_bz+=_bF.scrollLeft;_bA+=_bF.scrollTop;}if(_X==window){_bI();_bB=_bG.width;_bC=_bG.height;}else if(_1(_X=_0(_X))){_bB=_X.offsetWidth;_bC=_X.offsetHeight;if(!(_bB&&_bC)&&_X.tagName=='DIV'){for(var _bJ=_X.childNodes,_bK=_bJ.length;--_bK>=0;){if(_bJ[_bK].nodeName.charAt(0)!='#'){var _bL=_by(_bJ[_bK]);if(_bL.width||_bL.height){_bB=Math.max(_bB,_bL.right-_bz+1);_bC=Math.max(_bC,_bL.bottom-_bA+1);}}}}function _bM(_X){return _bN(_X,'display')=='none'||_bN(_X,'visibility')==_i;}
if(_X.tagName=='A'&&_X.childNodes.length==1&&_X.childNodes[0].tagName=='IMG')_X=_X.childNodes[0];var _bO=_bD= !_bM(_X),_bP=_X,_bQ=_X,_bR=_bG.width,_bS=_bG.height,_bT=_bF.scrollLeft,_bU=_bF.scrollTop,_bV=_bT+_bR,_bW=_bU+_bS;while(_bQ.parentNode&&typeof _bQ.parentNode!='unknown'){var _bX=_bQ.offsetLeft||0,_bY=_bQ.offsetTop||0,_bZ=_bQ.offsetWidth,_b0=_bQ.offsetHeight;if(_bD&&_bM(_bQ))_bD=_g;if(_bQ==_bP){_bz+=_bX+(parseInt(_bN(_bQ,'borderLeftWidth'))||0);_bA+=_bY+(parseInt(_bN(_bQ,'borderTopWidth'))||0);_bP=_bQ.offsetParent;_bN(_bQ,'position')=='fixed'&&_bI();}if(_bQ!=_X&&_bQ!=document.body&&_bQ!=document.documentElement&&(_bQ.scrollWidth>_bZ||_bQ.scrollHeight>_b0)){_bz-=_bQ.scrollLeft;_bA-=_bQ.scrollTop;if(_o){_bz+=_bQ.clientLeft;_bA+=_bQ.clientTop;}if(_bD)_bD=_6(_bz,_bA,_bB,_bC,_bX,_bY,_bZ,_b0);}_bQ=_bQ.parentNode;}if(_bD)_bD=_6(_bz,_bA,_bB,_bC,_bT,_bU,_bR,_bS);_bE=_bD?((Math.min(_bz+_bB,_bV)-Math.min(Math.max(_bz,_bT),_bV))*(Math.min(_bA+_bC,_bW)-Math.min(Math.max(_bA,_bU),_bW)))/(_bB*_bC)*100:0;}return{x:_bz,
y:_bA,width:_bB,height:_bC,area:_bB*_bC,left:_bz,top:_bA,right:_bz+_bB-1,bottom:_bA+_bC-1,seen:_bD,percentSeen:_bE};};var _bH=_a.getDimensions=function(_X){if(_X==window){var _bF=document.documentElement;return{width:_bF.clientWidth||window.innerWidth||_bF.offsetWidth,height:_bF.clientHeight||window.innerHeight||_bF.offsetHeight};}else if(_X=_0(_X)){return{width:_X.offsetWidth||parseInt(_bN(_X,'width'))||0,height:_X.offsetHeight||parseInt(_bN(_X,'height'))||0};}else{return{width:0,height:0};}};var _b1={borderColor:['border','Color'],borderWidth:['border','Width'],padding:1,margin:1},_bN=_a.getStyle=function(_X,_b2){var _b3='';if(typeof _b2==_c){if(_X){var _b4=_o&&_b2=='opacity',_b5=document.defaultView,_b6=_b5&&_b5.getComputedStyle(_X,'');if(_b4)_b2='filter';if(_b6){if(!(_b3=_b6[_b2])){var _b7=_b1[_b2];if(_b7){var _b8=_b7[0]||_b2,_b9=_b7[1]||'',_ca=_b6[_b8+'Top'+_b9],_cb=_b6[_b8+'Right'+_b9],_cc=_b6[_b8+'Bottom'+_b9],_cd=_b6[_b8+'Left'+_b9];_b3=_ca==_cb&&_cb==_cc&&_cc==_cd?_cd:_ca+' '+_cb+' '+_cc+' '+_cd;}}
}else{var _ce=_X.currentStyle;_b3=_ce?_ce.getAttribute(_b2):_X.style[_b2];}if(_b4){var _cf=(_b3||'').match(/alpha\s*\(\s*opacity\s*=([^\)]*)\)/i);_b3=_cf?_cf[1]/100:1;}}}else{_b3={};if(_X)for(_b2 in _b2)_b3[_b2]=_bN(_X,_b2);}return _b3;};var _cg=_a.getText=function(_X){var _ch='';if(_X=_0(_X)){function _ci(_X){if(typeof _X.innerText==_c){_ch+=_X.innerText.replace(/\r|\n|\r\n/g,'');}else if(typeof _X.textContent==_c){_ch+=_X.textContent;}else{if(_X.nodeType==3)_ch+=_X.data;if(_X.childNodes){for(var _bK= -1,_bJ=_X.childNodes,_cj=_bJ.length;++_bK<_cj;)_cg(_bJ[_bK]);}}}_ci(_X);}return _ch;};_a.getValue=function(_X){var _b3;if(_X=_0(_X)){if(_1(_X)){var _ck=_X.tagName;if(_ck=='TEXTAREA'){_b3=_X.value;}else if(_ck=='INPUT'){_b3=_X.type=='checkbox'?_X.checked:_X.value;}else if(_ck=='SELECT'){if(_X.multiple){_b3=[];for(var _cl= -1,_cm=_X.options,_cn=_cm.length,_co;++_cl<_cn;)(_co=_cm[_cl]).selected&&_b3.push(_co.value);}else{_b3=_X.value;}}else if(_ck=='IMG'){_b3=_X.src;}else{
_b3=_X.innerHTML.replace(/<br\/?>/gi,'\n').replace(/&nbsp;/g,' ');}}else{_b3=(Uize.findRecord(_X,{tagName:'INPUT',type:'radio',checked:_f})||{}).value;}}return _b3;};_a.injectHtml=function(_U,_cp,_cq){var _cr,_cs,_ct,_cu,_cv,_cw,_cx=Uize.isArray(_cp)||(_1(_cp)&&(_cp=[_cp]));((_cr=_cq=='inner replace')||(_cs=_cq=='outer replace')||(_ct=_cq=='inner top')||(_cu=_cq=='outer top')||(_cv=_cq=='outer bottom')||(_cw=_f));_cx||(_cp+='');_W(_U,function(_X){var _cy=_X.childNodes;function _cz(_cA){return _cA&&/<script/i.test(_cA)}function _cB(){return _cz(_cp)}if((_cr||(!_cy.length&&(_ct||_cw)))&& !_1&& !_cB()){_X.innerHTML=_cp;}else if(_cs&&_o&& !_1&& !_cB()){_X.outerHTML=_cp;}else{if(_cr)if(_o&&_p[_X.tagName]){var _cC=_X.cloneNode();_X.replaceNode(_cC);_X=_cC;}else _X.innerHTML='';if(_cx){var _cD=[];for(var _bs= -1,_cE=_cp.length;++_bs<_cE;)_cD.push(_cp[_bs].cloneNode(_f));}else{var _cF=document.createElement('DIV');_cF.innerHTML='<i>e</i>'+_cp;var _cD=_cF.childNodes}var _cG=_ct?_cy[0]:_cv?_X.nextSibling:_X,
_cH=_X.parentNode,_cI= +!_cx;function _cJ(_X){if(_X.tagName=='SCRIPT'){var _cK=document.createElement('script');if(_X.id)_cK.id=_X.id;if(_X.type)_cK.type=_X.type;_cK.text=_X.text;if(_X.src)_cK.src=_X.src;_X.parentNode.replaceChild(_cK,_X);}else if(_cz(_X.innerHTML)){for(var _bK= -1,_cy=_X.childNodes,_cL=_cy.length;++_bK<_cL;)_cJ(_cy[_bK]);}}while(_cD.length>_cI){var _cM=_cx?_cD.shift():_cD[_cI];if(_cw||_cr){_X.appendChild(_cM);}else if(_ct){_cG?_X.insertBefore(_cM,_cG):_X.appendChild(_cM);}else if(_cu||_cs){_cH.insertBefore(_cM,_cG);}else if(_cv){_cG?_cH.insertBefore(_cM,_cG):_cH.appendChild(_cM);}_cx||_cJ(_cM);}_cs&&_cH.removeChild(_X);}});};var _1=_a.isNode=function(_X){return!!(_X&&typeof _X==_d&&(_X.getAttribute||_X.documentElement||(_X.self&&_X.self==_X)));};var _bt=_a.isOnNodeTree=function(_X,_cN){_X=_0(_X);_cN=_0(_cN);while(_X){if(_X==_cN)return _f;_X=_X.parentNode;}return _g;};var _bg=_a.joinIdPrefixAndNodeId=function(_Y,_A){return(_Y||'')+(_Y&&_A?'-':'')+_A;};_a.remove=function(_U){
_W(_U,function(_X){_X.parentNode.removeChild(_X)});};_a.setClipRect=function(_U,_ca,_cb,_cc,_cd){var _cO='rect('+_ca+'px, '+_cb+'px, '+_cc+'px, '+_cd+'px)';_W(_U,function(_X){_X.style.clip=_cO});};var _cP=['left','top','width','height'];_a.setCoords=function(_U,_cQ){_cR(_U,typeof _cQ.length=='number'?_I(_cP,_cQ):_cQ);};_a.centerInWindow=function(_U){var _cS=_by(window);_W(_U,function(_X){var _cT=_bH(_X);_a.setCoords(_X,{left:_cS.x+((_cS.width-_cT.width)>>1),top:_cS.y+((_cS.height-_cT.height)>>1)});});};_a.getEventAbsPos=function(_cU){var _cV=(_cU||(_cU=_y)).targetTouches;if(_cV&&_cV.length)_cU=_cV[0];if(_cU.pageX!=_b){return{left:_cU.pageX,top:_cU.pageY};}else{var _bF=_C();return{left:_cU.clientX+_bF.scrollLeft,top:_cU.clientY+_bF.scrollTop};}};var _cW=_a.setAbsPos=function(_U,_cX,_cY){_cY=typeof _cY=='number'?{x:_cY,y:_cY}:(_cY||{x:0,y:0});var _bF=document[_q?'body':'documentElement'],_cZ=_bH(window);_W(_U,function(_X){function _c0(_c1,_c2,_c3,_c4){var _c5=_cX[_c1],_c6=_cY[_c4],_c7=_c5-_bF[_c2],
_c8=_c6+_cT[_c3];return(_c5+(_c7+_c8>_cZ[_c3]?Math.max(-_c8,-_c7):_c6));}var _cT=_bH(_X);_cR(_X,{left:_c0('left','scrollLeft','width','x'),top:_c0('top','scrollTop','height','y'),right:'auto',bottom:'auto'});});};_a.setAbsPosAdjacentTo=function(_U,_c9,_da){_c9=_0(_c9);var _db=_by(_c9),_dc=_db.width/2,_dd=_db.height/2,_de=_da=='x'? -1:1;if(!_dc&& !_dd)_db=_a.getEventAbsPos();_W(_U,function(_X){_cW(_X,{left:_db.left+_dc,top:_db.top+_dd},{x:-_dc*_de,y:_dd*_de});});};_a.setInnerHtml=function(_U,_cA){_cA+='';_W(_U,function(_X){_X.innerHTML=_cA});};var _df={};_a.setOpacity=function(_U,_dg){_df.opacity=_dg;_cR(_U,_df);};_a.setProperties=function(_U,_bh){_W(_U,function(_X){_j(_X,_bh)});};var _cR=_a.setStyle=function(_U,_bh){_W(_U,function(_X){var _dh=_X.style,_di;if(_o&&'opacity'in _bh)_dh.filter=(_di=Math.round(_bh.opacity*100))<100?'alpha(opacity='+_di+')':'';for(var _b2 in _bh)_dh[_b2]=(typeof(_di=_bh[_b2])==_d&&_di?(_di=_di.valueOf()):_di)!=_b?(typeof _di=='number'&&_b2!='opacity'&&_b2!='zIndex'
?Math.round(_di)+'px':_di+''):'';});};_a.setValue=function(_U,_b3){_b3+='';_W(_U,function(_X){var _ck=_X.tagName,_dj=_X.readOnly;if(_dj)_X.readOnly=_g;if(_ck=='TEXTAREA'){_X.value=_b3;}else if(_ck=='INPUT'){var _dk=_X.type;if(_dk=='text'||_dk==_i||_dk=='password'){_X.value=_b3;}else if(_dk=='checkbox'){_X.checked=_b3=='true';}else if(_dk=='radio'){_X.checked=_X.value==_b3;}}else if(_ck=='SELECT'){if(!_b3){_X.selectedIndex= -1;}else{var _cm=_X.options;if(_X.multiple&&(_b3=='*'||_b3.indexOf(',')> -1)){var _dl;if(_b3!='*'){_dl={};for(var _K=_b3.split(','),_L=_K.length;--_L>=0;)_dl[_K[_L]]=1;}for(var _cl=_cm.length,_co;--_cl>=0;)(_co=_cm[_cl]).selected= !_dl||_dl[_co.value];}else{_X.selectedIndex=Uize.findRecordNo(_cm,{value:_b3},_X.selectedIndex);}}}else if(_ck=='IMG'){if(_b3)_X.src=_b3;}else{_ck=='PRE'&&_o?(_X.innerText=_b3):(_X.innerHTML=_b3.replace(/</g,'&lt;').replace(/\n/g,'<br/>'));}if(_dj)_X.readOnly=_dj;});};_a.show=function(_U,_dm){_cR(_U,{visibility:_dm||_dm===_b?'inherit':_i});};
_a.showClickable=function(_U,_dn){_cR(_U,{cursor:_dn||_dn===_b?(_v?'hand':'pointer'):'default'});};var _do=_a.unwire=function(_U,_dp,_dq,_dr){if(typeof _dp==_d&&_dp&& !_dp.virtualDomEvent){for(var _H in _dp)_do(_U,_H,_dp[_H],_dq);}else{_a.unwireEventsByOwnerId(_dr,_U!==_b||_dp!=_b||_dq!=_b?{node:_U,eventName:_dp,handler:_dq}:_b);}};_a.unwireEventsByOwnerId=function(_ds,_dt){var _du=_O[_ds=_ds||''];if(_du){function _dv(_dw){if(_dw!==_h){var _dx=_dt&&_dt.eventName,_dy=_dt&&_dt.handler,_dz=_dw||_dx||_dy;if(_dx&&_dx.charCodeAt)_dx=_G(_dx);for(var _dA=_du.length;--_dA>=0;){var _dB=_du[_dA],_dC=_N[_dB],_X=_dC._X,_H=_dC._H;if(!_dz||((!_dw||_dw==(_dC._dD||_X))&&(!_dx||_dx==_H)&&(!_dy||_dy==_dC._dE))){_dz&&_du.splice(_dA,1);if(_dC._dF){_a.unwireEventsByOwnerId(_dC._dF)}else{try{_X==window?_dG.unwire(_H,_dC._dH):_o?_X.detachEvent('on'+_H,_dC._dH):_X.removeEventListener(_H,_dC._dH,_g);}catch(_dI){}}delete _N[_dB];}}(_dz&&_du.length)||delete _O[_ds];}}_dt&&_dt.node!==_b?_W(_dt.node,_dv):_dv();}};var _dJ=_D(function(_dB){
return(function(_x){var _dC=window.Uize&&Uize.Node._N[_dB];return _dC&&_dC._dE.call(_dC._X,_x.windowEvent);});}),_dK=_D(function(_dB){return(function(_x){var _dC=window.Uize&&Uize.Node._N[_dB];return _dC&&_dC._dE.call(_dC._X,_x||window.event);});}),_dL={click:_dK,mouseover:_D(function(_dB){return(function(_x){var _dC=window.Uize&&Uize.Node._N[_dB],_dM=(_x||(_x=window.event)).fromElement||_x.relatedTarget;if(_dC){if(_dM){try{if(!_dM.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dM,_dC._X))_dM=null;}catch(_dI){_dM=null;}}if(!_dM){Uize.Node._w(_x);return _dC._dE.call(_dC._X,_x);}}});}),mouseout:_D(function(_dB){return(function(_x){var _dC=window.Uize&&Uize.Node._N[_dB],_dN=(_x||(_x=window.event)).toElement||_x.relatedTarget;if(_dC){if(_dN){try{if(!_dN.Uize_Widget_Drag_shield&& !Uize.Node.isOnNodeTree(_dN,_dC._X))_dN=null;}catch(_dI){_dN=null;}}if(!_dN)return _dC._dE.call(_dC._X,_x);}});}),mousedown:_dK,mouseup:_dK};_a.wire=function(_U,_H,_dE,_ds){if(!_H)return;if(_ds==_b)_ds='';var _dO;if(_H.charCodeAt)
_H=_G(_H);if(typeof _H==_d&& !(_dO= !!_H.virtualDomEvent)){_ds=arguments[2]||'';for(var _x in _H)_a.wire(_U,_x,_H[_x],_ds);return;}_W(_U,function(_X){var _ck=_X.tagName;(_O[_ds]||(_O[_ds]=[])).push(_P);var _dH=(_dO?_a.returnFalse:_X==window?_dJ:_dL[_H]||_dK)(_P);var _dC=_N[_P++]={_X:_X,_H:_H,_dE:_dE,_dH:_dH};if(_t&&_ck=='BODY'&&_H=='scroll'){_dC._dD=_X;_X=_dC._X=document;}if(_dH){var _dP='on'+_H;_X==window?_dG.wire(_H,_dH):_o?_X.attachEvent(_dP,_dH):_X.addEventListener(_H,_dH,_g);if(_ck=='A'&&(_H=='mousedown'||_H=='click')&& !_X[_dP])_X[_dP]=_a.returnFalse;}else if(_dO){_H.wire(_X,_dE,_dC._dF=Uize.getGuid());}});};_a.returnFalse=new Function('return false');_a.returnTrue=new Function('return true');_a.ieMajorVersion=_u;_a.isIe=_o;_a.isSafari=_q;_a.isMozilla=_r;if(_l){_a.wire(document.documentElement,'mousemove',_w);var _dG=new Uize,_dQ=setTimeout(function(){_dG.fire('load')},15000);function _dR(_dS){var _dT='on'+_dS,_dU=window[_dT]||_a.returnFalse;window[_dT]=function(_x){_dS=='load'&&clearTimeout(_dQ);
_dU.call(window,_x||(_x=window.event));_dG.fire({name:_dS,windowEvent:_x});};}for(var _dS in{focus:1,blur:1,load:1,beforeunload:1,unload:1,resize:1,scroll:1})_dR(_dS);;}return _a;}});