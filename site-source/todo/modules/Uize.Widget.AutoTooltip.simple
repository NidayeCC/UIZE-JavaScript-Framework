TODO
- handle case of nodes being changed in "mid flight"

